{"version":3,"file":"10.8e18e160.js","sources":["../../../../../../src/routes/maintainers/[domain]/edit/+page.svelte"],"sourcesContent":["<script>\n\texport let data;\n\timport { goto } from '$app/navigation';\n\timport Fa from 'svelte-fa';\n\timport { toastStore } from '@skeletonlabs/skeleton';\n\n\t//close icon\n\timport { faXmark } from '@fortawesome/free-solid-svg-icons';\n\timport { ProgressRadial } from '@skeletonlabs/skeleton';\n\timport { fade } from 'svelte/transition';\n\n\tlet saving = false;\n\tlet records = data.domain.record || [];\n\n\tlet availableRecords = [\n\t\t{\n\t\t\ttype: 'CNAME',\n\t\t\tallowMultiple: false\n\t\t},\n\t\t{\n\t\t\ttype: 'A',\n\t\t\tallowMultiple: false\n\t\t},\n\t\t{\n\t\t\ttype: 'URL',\n\t\t\tallowMultiple: false\n\t\t},\n\t\t{\n\t\t\ttype: 'MX',\n\t\t\tallowMultiple: true\n\t\t},\n\t\t{\n\t\t\ttype: 'TXT',\n\t\t\tallowMultiple: true\n\t\t}\n\t];\n\trecords.forEach((r) => {\n\t\tr.allowMultiple = availableRecords.find((ar) => ar.type === r.type).allowMultiple;\n\t});\n</script>\n\n<h2 class=\"h2\">Editing {data.domain.name}.is-cool.me</h2>\n<br />\n{#if !saving}\n\t<div in:fade={{ duration: 300 }} class=\"flex flex-col gap-5\">\n\t\t<select\n\t\t\tclass=\"select mb-2\"\n\t\t\ton:change={(e) => {\n\t\t\t\t//if now selected value is not empty, add it to records\n\t\t\t\tif (e.target.value !== '')\n\t\t\t\t\trecords = [...records, availableRecords.find((r) => r.type === e.target.value)];\n\n\t\t\t\te.target.value = '';\n\t\t\t}}\n\t\t>\n\t\t\t<option value=\"\" selected disabled> Add record </option>\n\t\t\t{#each availableRecords as record}\n\t\t\t\t{#if (!record.allowMultiple && records.find((r) => r.allowMultiple === false)) || records.find((r) => r.type === record.type)}\n\t\t\t\t\t<option value=\"\" disabled>{record.type}</option>\n\t\t\t\t{:else}\n\t\t\t\t\t<option value={record.type}>{record.type}</option>\n\t\t\t\t{/if}\n\t\t\t{/each}\n\t\t</select>\n\t\t{#if records.length > 0}\n\t\t\t{#each records as record}\n\t\t\t\t<div class=\"flex items-center gap-2\">\n\t\t\t\t\t<label class=\"label\" for={record.type}>{record.type}</label>\n\t\t\t\t\t<input\n\t\t\t\t\t\tclass=\"input\"\n\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\tplaceholder={record.type}\n\t\t\t\t\t\tid={record.type}\n\t\t\t\t\t\tvalue={record.value || ''}\n\t\t\t\t\t\ton:change={(e) => (record.value = e.target.value)}\n\t\t\t\t\t/>\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\"btn variant-filled-error\"\n\t\t\t\t\t\ton:click={() => (records = records.filter((r) => r.type !== record.type))}\n\t\t\t\t\t>\n\t\t\t\t\t\t<Fa icon={faXmark} />\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t{/each}\n\n\t\t\t<button\n\t\t\t\tclass=\"btn variant-filled-success mt-5\"\n\t\t\t\ton:click={async () => {\n\t\t\t\t\tsaving = true;\n\t\t\t\t\tlet toFetch = `/api/domains/${data.domain.name}/edit?`;\n\n\t\t\t\t\tlet toAdd = {\n\t\t\t\t\t\trecords: JSON.stringify(records)\n\t\t\t\t\t};\n\t\t\t\t\tfor (const [key, value] of Object.entries(toAdd)) {\n\t\t\t\t\t\ttoFetch += `${key}=${value}&`;\n\t\t\t\t\t}\n\n\t\t\t\t\tlet response = await fetch(toFetch, {\n\t\t\t\t\t\tmethod: 'PATCH'\n\t\t\t\t\t})\n\t\t\t\t\t\t.then((res) => res.json())\n\t\t\t\t\t\t.catch((err) => {\n\t\t\t\t\t\t\tconsole.error(err);\n\t\t\t\t\t\t\treturn { error: true };\n\t\t\t\t\t\t});\n\t\t\t\t\tif (response.error) {\n\t\t\t\t\t\ttoastStore.trigger({\n\t\t\t\t\t\t\tbackground: 'variant-filled-error',\n\t\t\t\t\t\t\tmessage: `${response.error}`,\n\t\t\t\t\t\t\ttimeout: 3000\n\t\t\t\t\t\t});\n\t\t\t\t\t\tsaving = false;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tsaving = false;\n\t\t\t\t\ttoastStore.trigger({\n\t\t\t\t\t\tbackground: 'variant-filled-success',\n\t\t\t\t\t\tmessage: `Successfully updated records.`,\n\t\t\t\t\t\ttimeout: 3000\n\t\t\t\t\t});\n\t\t\t\t\tgoto('/domains/' + data.domain.name);\n\t\t\t\t}}>Save</button\n\t\t\t>\n\t\t{:else}\n\t\t\t<p>Add a record to your domain to get started.</p>\n\t\t{/if}\n\t</div>\n{:else}\n\t<div in:fade={{ duration: 300 }} out:fade={{ duration: 300 }} class=\"flex flex-col gap-5\">\n\t\t<ProgressRadial class=\"mt-5\" size=\"small\" />\n\t</div>\n{/if}\n"],"names":["insert_hydration","target","div","anchor","div_intro","create_in_transition","fade","div_outro","create_out_transition","ctx","i","append_hydration","select","option","t_value","func","func_1","p","button","each_blocks","t0_value","faXmark","attr","label","label_for_value","input","input_placeholder_value","input_id_value","current","dirty","set_data","t0","input_value_value","h2","br","t1","t1_value","r","data","$$props","saving","records","availableRecords","ar","record","e","$$invalidate","change_handler_1","each_value","record_index","click_handler","toFetch","toAdd","key","value","response","res","err","toastStore","goto"],"mappings":"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"}