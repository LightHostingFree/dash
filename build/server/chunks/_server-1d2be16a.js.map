{"version":3,"file":"_server-1d2be16a.js","sources":["../../../../src/routes/login/authorize/+server.js"],"sourcesContent":["import { json } from '@sveltejs/kit';\nimport { getJWT, createJWT } from '$lib/jwt.js';\nimport { env } from '$env/dynamic/private';\nimport { redirect } from '@sveltejs/kit';\nexport function GET({ url, cookies }) {\n\tlet next = url.searchParams.get('next');\n\tif (!next) return json({ error: 'No next URL provided' });\n\tlet provider = url.searchParams.get('provider');\n\tif (!provider) return json({ error: 'No provider provided' });\n\tif (!env[`PROVIDER_${provider.toUpperCase()}_SECRET`])\n\t\treturn json({ error: 'Invalid provider provided' });\n\tlet session = getJWT(cookies.get('jwt'));\n\tif (!session)\n\t\tthrow redirect(\n\t\t\t303,\n\t\t\t`/login/in?next=${encodeURIComponent(\n\t\t\t\t`/login/authorize?next=${encodeURIComponent(next)}&provider=${provider}`\n\t\t\t)}`\n\t\t);\n\tlet jwt = createJWT(session, env[`PROVIDER_${provider.toUpperCase()}_SECRET`]);\n\tthrow redirect(303, `${next}?jwt=${jwt}`);\n}\n"],"names":["env"],"mappings":";;;;;;AAIA,SAAA,GAAA,CAAA,EAAA,GAAA,EAAA,OAAA,EAAA,EAAA;AACA,EAAA,IAAA,IAAA,GAAA,GAAA,CAAA,YAAA,CAAA,GAAA,CAAA,MAAA,CAAA,CAAA;AACA,EAAA,IAAA,CAAA,IAAA;AAAA,IAAA,OAAA,IAAA,CAAA,EAAA,KAAA,EAAA,sBAAA,EAAA,CAAA,CAAA;AACA,EAAA,IAAA,QAAA,GAAA,GAAA,CAAA,YAAA,CAAA,GAAA,CAAA,UAAA,CAAA,CAAA;AACA,EAAA,IAAA,CAAA,QAAA;AAAA,IAAA,OAAA,IAAA,CAAA,EAAA,KAAA,EAAA,sBAAA,EAAA,CAAA,CAAA;AACA,EAAA,IAAA,CAAAA,WAAA,CAAA,CAAA,SAAA,EAAA,QAAA,CAAA,WAAA,EAAA,CAAA,OAAA,CAAA,CAAA;AACA,IAAA,OAAA,IAAA,CAAA,EAAA,KAAA,EAAA,2BAAA,EAAA,CAAA,CAAA;AACA,EAAA,IAAA,OAAA,GAAA,MAAA,CAAA,OAAA,CAAA,GAAA,CAAA,KAAA,CAAA,CAAA,CAAA;AACA,EAAA,IAAA,CAAA,OAAA;AACA,IAAA,MAAA,QAAA;AAAA,MACA,GADA;AACA,MACA,CADA,eAAA,EACA,kBADA;AACA,QACA,CADA,sBAAA,EACA,kBADA,CACA,IAAA,CAAA,CADA,UAAA,EACA,QAAA,CADA,CAAA;AACA,OACA,CADA,CAAA;AACA,KAAA,CAAA;AAEA,EAAA,IAAA,GAAA,GAAA,SAAA,CAAA,OAAA,EAAAA,WAAA,CAAA,CAAA,SAAA,EAAA,QAAA,CAAA,WAAA,EAAA,CAAA,OAAA,CAAA,CAAA,CAAA,CAAA;AACA,EAAA,MAAA,QAAA,CAAA,GAAA,EAAA,CAAA,EAAA,IAAA,CAAA,KAAA,EAAA,GAAA,CAAA,CAAA,CAAA,CAAA;AACA;;;;"}